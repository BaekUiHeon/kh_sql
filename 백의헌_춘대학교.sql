DROP TABLE TB_GRADE;
DROP TABLE TB_STUDENT;
DROP TABLE TB_CLASS_PROFESSOR;
DROP TABLE TB_PROFESSOR;
DROP TABLE TB_CLASS;
DROP TABLE TB_DEPARTMENT;


CREATE TABLE "TB_DEPARTMENT" (
	"DEPARTMENT_NO"	VARCHAR(10)		NOT NULL,
	"DEPARTMENT_NAME"	VARCHAR(20)		NULL,
	"CATEGORY"	VARCHAR(20)		NULL,
	"OPEN_YN"	CHAR(1)		NULL,
	"CAPACITY"	NUMBER		NULL
);



CREATE TABLE "TB_STUDENT" (
	"STUDENT_NO"	VARCHAR2(10)		NOT NULL,
	"DEPARTMENT_NO"	VARCHAR(10)		NOT NULL,
	"STUDENT_NAME"	VARCHAR2(30)		NOT NULL,
	"STUDENT_SSN"	VARCHAR2(14)		NULL,
	"STUDENT_ADDRESS"	VARCHAR(255)		NULL,
	"ENTRANCE_DATE"	DATE		NULL,
	"ABSENCE_YN"	CHAR(1)		NULL
);



CREATE TABLE "TB_CLASS" (
	"CLASS_NO"	VARCHAR2(10)		NOT NULL,
	"DEPARTMENT_NO"	VARCHAR(10)		NOT NULL,
	"PREATTENDING_CLASS_NO"	VARCHAR2(10)		NOT NULL,
	"CLASS_NAME"	VARCHAR2(30)		NOT NULL,
	"CLASS_TYPE"	VARCHAR(10)		NULL
);



CREATE TABLE "TB_PROFESSOR" (
	"PROFESSOR_NO"	VARCHAR2(10)		NOT NULL,
	"PROFESSOR_NAME"	VARCHAR2(30)		NOT NULL,
	"PROFESSOR_SSN"	VARCHAR2(14)		NULL,
	"PROFESSOR_ADDRESS"	VARCHAR2(100)		NULL,
	"DEPARTMENT_NO"	VARCHAR(10)		NOT NULL
);



CREATE TABLE "TB_CLASS_PROFESSOR" (
	"CLASS_NO"	VARCHAR2(10)		NOT NULL,
	"PROFESSOR_NO"	VARCHAR2(10)		NOT NULL
);



CREATE TABLE "TB_GRADE" (
	"TERM_NO"	VARCHAR2(10)		NOT NULL,
	"CLASS_NO"	VARCHAR2(10)		NOT NULL,
	"STUDENT_NO"	VARCHAR2(10)		NOT NULL,
	"POINT"	NUMBER(3,2)		NULL
);

ALTER TABLE "TB_DEPARTMENT" ADD CONSTRAINT "PK_TB_DEPARTMENT" PRIMARY KEY (
	"DEPARTMENT_NO"
);

ALTER TABLE "TB_STUDENT" ADD CONSTRAINT "PK_TB_STUDENT" PRIMARY KEY (
	"STUDENT_NO"
);

ALTER TABLE "TB_CLASS" ADD CONSTRAINT "PK_TB_CLASS" PRIMARY KEY (
	"CLASS_NO"
);

ALTER TABLE "TB_PROFESSOR" ADD CONSTRAINT "PK_TB_PROFESSOR" PRIMARY KEY (
	"PROFESSOR_NO"
);

ALTER TABLE "TB_CLASS_PROFESSOR" ADD CONSTRAINT "PK_TB_CLASS_PROFESSOR" PRIMARY KEY (
	"CLASS_NO",
	"PROFESSOR_NO"
);

ALTER TABLE "TB_GRADE" ADD CONSTRAINT "PK_TB_GRADE" PRIMARY KEY (
	"TERM_NO",
	"CLASS_NO",
	"STUDENT_NO"
);

ALTER TABLE "TB_STUDENT" ADD CONSTRAINT "FK_TB_DEPARTMENT_TO_TB_STUDENT_1" FOREIGN KEY (
	"DEPARTMENT_NO"
)
REFERENCES "TB_DEPARTMENT" (
	"DEPARTMENT_NO"
);

ALTER TABLE "TB_CLASS" ADD CONSTRAINT "FK_TB_DEPARTMENT_TO_TB_CLASS_1" FOREIGN KEY (
	"DEPARTMENT_NO"
)
REFERENCES "TB_DEPARTMENT" (
	"DEPARTMENT_NO"
);

ALTER TABLE "TB_CLASS" ADD CONSTRAINT "FK_TB_CLASS_TO_TB_CLASS_1" FOREIGN KEY (
	"PREATTENDING_CLASS_NO"
)
REFERENCES "TB_CLASS" (
	"CLASS_NO"
);

ALTER TABLE "TB_PROFESSOR" ADD CONSTRAINT "FK_TB_DEPARTMENT_TO_TB_PROFESSOR_1" FOREIGN KEY (
	"DEPARTMENT_NO"
)
REFERENCES "TB_DEPARTMENT" (
	"DEPARTMENT_NO"
);

ALTER TABLE "TB_CLASS_PROFESSOR" ADD CONSTRAINT "FK_TB_CLASS_TO_TB_CLASS_PROFESSOR_1" FOREIGN KEY (
	"CLASS_NO"
)
REFERENCES "TB_CLASS" (
	"CLASS_NO"
);

ALTER TABLE "TB_CLASS_PROFESSOR" ADD CONSTRAINT "FK_TB_PROFESSOR_TO_TB_CLASS_PROFESSOR_1" FOREIGN KEY (
	"PROFESSOR_NO"
)
REFERENCES "TB_PROFESSOR" (
	"PROFESSOR_NO"
);

ALTER TABLE "TB_GRADE" ADD CONSTRAINT "FK_TB_CLASS_TO_TB_GRADE_1" FOREIGN KEY (
	"CLASS_NO"
)
REFERENCES "TB_CLASS" (
	"CLASS_NO"
);

ALTER TABLE "TB_GRADE" ADD CONSTRAINT "FK_TB_STUDENT_TO_TB_GRADE_1" FOREIGN KEY (
	"STUDENT_NO"
)
REFERENCES "TB_STUDENT" (
	"STUDENT_NO"
);

SELECT * FROM TB_DEPARTMENT;

INSERT INTO TB_DEPARTMENT VALUES('001','정보통신공학','공학','Y','40');
INSERT INTO TB_DEPARTMENT VALUES('002','수학과','자연과학','Y','40');

INSERT INTO TB_PROFESSOR VALUES('01','김학도','950219-1111111','신림동','001');
INSERT INTO TB_PROFESSOR VALUES('02','김망고','950219-1111112','신림동','002');

INSERT INTO TB_STUDENT VALUES('011','001','백의헌','952222-1222222','만학동','2013-03-10','Y');
INSERT INTO TB_STUDENT VALUES('012','002','손승환','952222-2222322','만학동','2012-03-10','Y');

INSERT INTO TB_CLASS VALUES('101','001','101','공업수학','공학');
INSERT INTO TB_CLASS VALUES('102','002','102','수학','과학');

INSERT INTO TB_CLASS_PROFESSOR VALUES('101','01');
INSERT INTO TB_CLASS_PROFESSOR VALUES('102','02');

INSERT INTO TB_GRADE VALUES('200101','101','011','4.5');
INSERT INTO TB_GRADE VALUES('200102','101','012','4.5');